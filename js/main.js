let sidebarFn=()=>{let e=document.getElementById("toggle-menu"),t=document.getElementById("sidebar-menus"),o=document.getElementById("menu-mask"),n=document.body,a=e=>{n.style.overflow=e?"hidden":"",utils[e?"fadeIn":"fadeOut"](o,.5),t.classList.toggle("open",e)},i=()=>{t.classList.contains("open")&&a(!1)};e.addEventListener("click",()=>a(!0)),o.addEventListener("click",i),window.addEventListener("resize",()=>{utils.isHidden(e)&&t.classList.contains("open")&&i(),sco.refreshWaterFall()})},scrollFn=()=>{let o=document.getElementById("rightside"),n=document.getElementById("page-header"),a=0,t=utils.throttle(()=>{initThemeColor();var e=window.scrollY||document.documentElement.scrollTop,t=e>a;a=e,t=t,0<e?(n.classList.toggle("nav-visible",!t),n.classList.add("nav-fixed"),o&&(o.style.opacity="0.8",o.style.transform="translateX(-58px)")):(n.classList.remove("nav-fixed","nav-visible"),o&&(o.style.opacity="",o.style.transform=""))},200);window.addEventListener("scroll",e=>{t(e),0===window.scrollY&&(n.classList.remove("nav-fixed","nav-visible"),o)&&(o.style.cssText="opacity: ''; transform: ''")})},percent=()=>{var e=document.documentElement,t=document.body;let o=window.pageYOffset||e.scrollTop,n=Math.max(t.scrollHeight,e.scrollHeight,t.offsetHeight,e.offsetHeight,t.clientHeight,e.clientHeight)-e.clientHeight;var t=Math.round(o/n*100),a=document.querySelector("#nav-totop"),i=document.querySelector(".rs_show .top i"),s=document.querySelector("#percent"),e=window.scrollY+e.clientHeight>=(document.getElementById("post-comment")||document.getElementById("footer")).offsetTop;a?.classList.toggle("long",e||90<t),i?.classList.toggle("show",e||90<t),s.textContent=e||90<t?a?GLOBAL_CONFIG.lang.backtop:"":t,document.querySelectorAll(".needEndHide").forEach(e=>e.classList.toggle("hide",n-o<100))},showTodayCard=()=>{let e=document.getElementById("todayCard");document.querySelector(".topGroup")?.addEventListener("mouseleave",()=>e?.classList.remove("hide"))},initObserver=()=>{var e=document.getElementById("post-comment");let t=document.getElementById("pagination"),o=document.querySelector(".comment-barrage");e&&t&&new IntersectionObserver(e=>{e.forEach(e=>{t.classList.toggle("show-window",e.isIntersecting),GLOBAL_CONFIG.comment.commentBarrage&&(o.style.bottom=e.isIntersecting?"-200px":"0px")})}).observe(e)},addCopyright=()=>{if(GLOBAL_CONFIG.copyright){let{limit:o,author:n,link:a,source:i,info:s}=GLOBAL_CONFIG.copyright;document.body.addEventListener("copy",e=>{e.preventDefault();var t=window.getSelection().toString(),t=t.length>o?`${t}

${n}
${a}${window.location.href}
${i}
`+s:t;e.clipboardData.setData("text",t)})}},asideStatus=()=>{var e=utils.saveToLocal.get("aside-status");document.documentElement.classList.toggle("hide-aside","hide"===e)};function initThemeColor(){var e=0<(window.scrollY||document.documentElement.scrollTop)?"--efu-card-bg":PAGE_CONFIG.is_post?"--efu-main":"--efu-background";applyThemeColor(getComputedStyle(document.documentElement).getPropertyValue(e))}function applyThemeColor(e){var t=document.querySelector('meta[name="theme-color"]'),o=document.querySelector('meta[name="apple-mobile-web-app-status-bar-style"]');t?.setAttribute("content",e),o?.setAttribute("content",e),window.matchMedia("(display-mode: standalone)").matches&&(document.body.style.backgroundColor=e)}let handleThemeChange=t=>{var e=window.globalFn?.themeChange||{};Object.values(e).forEach(e=>e(t))},sco={lastWittyWord:"",wasPageHidden:!1,musicPlaying:!1,scrollTo(e){var e=document.getElementById(e);e&&(e=e.getBoundingClientRect().top+window.pageYOffset-80,window.scroll({top:e,behavior:"smooth"}))},musicBind(){var e=document.querySelector("#nav-music meting-js");e&&e.aplayer&&(this.isMusicBind=!0,e.onclick=()=>this.musicPlaying&&this.musicToggle(!0),e.aplayer.on("loadeddata",()=>{coverColor(!0)}))},musicToggle(e=!0){this.isMusicBind||this.musicBind();var t=document.querySelector("#nav-music"),o=document.querySelector("#nav-music meting-js"),n=document.getElementById("consoleMusic");this.musicPlaying=!this.musicPlaying,t.classList.toggle("playing",this.musicPlaying),t.classList.toggle("stretch",this.musicPlaying),n?.classList.toggle("on",this.musicPlaying),"undefined"!=typeof rm&&rm?.menuItems.music[0]&&(t=document.querySelector("#menu-music-toggle span"),n=document.querySelector("#menu-music-toggle i"),t.textContent=this.musicPlaying?GLOBAL_CONFIG.right_menu.music.stop:GLOBAL_CONFIG.right_menu.music.start,n.className="solitude fas "+(this.musicPlaying?"fa-pause":"fa-play")),e&&o&&(this.musicPlaying?o.aplayer.play():o.aplayer.pause())},musicSkipBack(){document.querySelector("meting-js")?.aplayer?.skipBack()},musicSkipForward(){document.querySelector("meting-js")?.aplayer?.skipForward()},switchCommentBarrage(){var e,t=document.querySelector(".comment-barrage"),o=document.querySelector("#consoleCommentBarrage");t&&(e="flex"===window.getComputedStyle(t).display,t.style.display=e?"none":"flex",o?.classList.toggle("on",!e),utils.saveToLocal.set("commentBarrageSwitch",!e,.2),rm?.menuItems.barrage)&&rm.barrage(e)},switchHideAside(){var e=document.documentElement.classList,t=document.querySelector("#consoleHideAside"),o=e.contains("hide-aside");utils.saveToLocal.set("aside-status",o?"show":"hide",1),e.toggle("hide-aside"),t.classList.toggle("on",!o)},switchKeyboard(){this.sco_keyboards=!this.sco_keyboards;var e=document.querySelector("#consoleKeyboard"),t=this.sco_keyboards?openKeyboard:closeKeyboard;e?.classList.toggle("on",this.sco_keyboards),t(),localStorage.setItem("keyboard",this.sco_keyboards),document.getElementById("keyboard-tips")?.classList.remove("show")},initConsoleState(){var e=document.querySelector("#consoleHideAside");e&&e.classList.toggle("on",document.documentElement.classList.contains("hide-aside"))},changeWittyWord(){var t=GLOBAL_CONFIG.aside.witty_words||[];if(0===t.length)document.getElementById("sayhi").textContent="Solitude",this.lastWittyWord=null;else{var o=document.getElementById("sayhi");let e;if(1===t.length)e=t[0];else for(;(e=t[Math.floor(Math.random()*t.length)])===this.lastWittyWord;);o.textContent=e,this.lastWittyWord=e}},switchDarkMode(){var e="dark"===document.documentElement.getAttribute("data-theme"),t=e?"light":"dark";document.documentElement.setAttribute("data-theme",t),utils.saveToLocal.set("theme",t,.02),utils.snackbarShow(GLOBAL_CONFIG.lang.theme[t],!1,2e3),"object"==typeof rm&&rm.mode(!e)&&rm.hideRightMenu(),handleThemeChange(t)},hideTodayCard:()=>document.getElementById("todayCard").classList.add("hide"),toTop:()=>utils.scrollToDest(0),showConsole:()=>document.getElementById("console")?.classList.toggle("show",!0),hideConsole:()=>document.getElementById("console")?.classList.remove("show"),refreshWaterFall(){let t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&setTimeout(()=>{waterfall(e.target).then(()=>{e.target.classList.add("show")})},300)})});document.querySelectorAll(".waterfall").forEach(e=>t.observe(e))},addRuntime(){var e=document.getElementById("runtimeshow");e&&GLOBAL_CONFIG.runtime&&(e.innerText=utils.timeDiff(new Date(GLOBAL_CONFIG.runtime),new Date)+GLOBAL_CONFIG.lang.day)},toTalk(t){["#wl-edit",".el-textarea__inner","#veditor",".atk-textarea"].forEach(e=>{e=document.querySelector(e);e&&(e.dispatchEvent(new Event("input",{bubble:!0,cancelable:!0})),e.value="> "+t.replace(/\n/g,"\n> ")+"\n\n",utils.scrollToDest(utils.getEleTop(document.getElementById("post-comment")),300),e.focus(),e.setSelectionRange(-1,-1))}),utils.snackbarShow(GLOBAL_CONFIG.lang.totalk,!1,2e3)},initbbtalk(){document.querySelector("#bber-talk")&&new Swiper(".swiper-container",{direction:"vertical",loop:!0,autoplay:{delay:3e3,pauseOnMouseEnter:!0}})},addPhotoFigcaption(){document.querySelectorAll(".article-container img:not(.gallery-item img)").forEach(e=>{var t=e.getAttribute("alt");t&&e.insertAdjacentHTML("afterend",`<div class="img-alt is-center">${utils.escapeHtml(t)}</div>`)})},scrollToComment:()=>utils.scrollToDest(utils.getEleTop(document.getElementById("post-comment")),300),setTimeState(){var e=document.getElementById("sayhi");if(e){let t=(new Date).getHours();var o=GLOBAL_CONFIG.aside.state,n=(e=>{for(var t of e){t=localStorage.getItem(t);if(t)return JSON.parse(t)}return null})(["twikoo","WALINE_USER_META","WALINE_USER","_v_Cache_Meta","ArtalkUser"]);var n=n?n.nick||n.display_name:null,a=this.wasPageHidden?GLOBAL_CONFIG.aside.witty_comment.back+n:GLOBAL_CONFIG.aside.witty_comment.prefix+n,n=[{start:0,end:5,text:n?a:o.goodnight},{start:6,end:10,text:n?a:o.morning},{start:11,end:14,text:n?a:o.noon},{start:15,end:18,text:n?a:o.afternoon},{start:19,end:24,text:n?a:o.night}].find(e=>t>=e.start&&t<=e.end);e.innerText=n.text}},tagPageActive(){var e=decodeURIComponent(window.location.pathname);/\/tags\/.*?\//.test(e)&&(e=e.split("/").slice(-2,-1)[0],e=document.getElementById(e))&&(document.querySelectorAll("a.select").forEach(e=>{e.classList.remove("select")}),e.classList.add("select"))},categoriesBarActive(){var e=document.querySelector("#category-bar"),t=decodeURIComponent(window.location.pathname),o=t===GLOBAL_CONFIG.root;e&&(e.querySelectorAll(".category-bar-item").forEach(e=>e.classList.remove("select")),e=o?"category-bar-home":t.split("/").slice(-2,-1)[0],o=document.getElementById(e))&&o.classList.add("select")},scrollCategoryBarToRight(){let t=document.getElementById("category-bar-items"),o=document.getElementById("category-bar-next");if(t){let e=()=>t.scrollLeft+t.clientWidth>=t.scrollWidth-8;t.addEventListener("scroll",()=>{clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>{o.style.transform=e()?"rotate(180deg)":""},150)}),t.scroll({left:e()?0:t.clientWidth,behavior:"smooth"})}},openAllTags(){document.querySelectorAll(".card-allinfo .card-tag-cloud").forEach(e=>e.classList.add("all-tags")),document.getElementById("more-tags-btn")?.remove()},listenToPageInputPress(){var o=document.querySelector(".toPageGroup");let n=document.getElementById("toPageText");if(n){let t=document.getElementById("toPageButton");var a=document.querySelectorAll(".page-number");let e=+a[a.length-1].textContent;n&&1!=e?(n.addEventListener("keydown",e=>{"Enter"===e.key&&(sco.toPage(),pjax.loadUrl(t.href))}),n.addEventListener("input",()=>{t.classList.toggle("haveValue",""!==n.value&&"0"!==n.value),+n.value>e&&(n.value=e)})):o.style.display="none"}},addNavBackgroundInit(){0!==document.documentElement.scrollTop&&document.getElementById("page-header").classList.add("nav-fixed","nav-visible")},toPage(){var e=document.querySelectorAll(".page-number"),e=parseInt(e[e.length-1].innerHTML),t=document.getElementById("toPageText"),t=parseInt(t.value);document.getElementById("toPageButton").href=!isNaN(t)&&t<=e&&1<t?window.location.href.replace(/\/page\/\d+\/$/,"/")+"page/"+t+"/":"/"},owoBig(o){let n=document.getElementById("owo-big");n||((n=document.createElement("div")).id="owo-big",document.body.appendChild(n));document.addEventListener("mouseover",e=>{var e=e.target,t=e.closest(o.item);t&&e.closest(o.body)&&(e=t.querySelector("img")?.src)&&(n.innerHTML=`<img src="${e}" style="max-width: 100%; height: auto;">`,n.style.display="block",(e=>{const t=e.getBoundingClientRect();n.style.left=`${t.left-n.offsetWidth/4}px`,n.style.top=`${t.top}px`})(t))}),document.addEventListener("mouseout",e=>{e.target.closest(o.item)&&e.target.closest(o.body)&&(n.style.display="none")})},changeTimeFormat(e){e.forEach(e=>{var t=e.getAttribute("datetime");e.textContent=utils.diffDate(t,!0),e.style.display="inline"})},switchComments(){var o=document.getElementById("switch-btn");if(o){let e=!1,t=document.getElementById("post-comment");utils.addEventListenerPjax(o,"click",()=>{t.classList.toggle("move"),e||"function"!=typeof loadTwoComment||(e=!0,loadTwoComment())})}},homeTypeit(){if("undefined"!=typeof home_subtitle){let t=new TypeIt(".banners-title-small",{speed:200,waitUntilVisible:!0,loop:!0,lifeLike:!0});home_subtitle.forEach(e=>{t.type(e).pause(500).delete(e)}),t.go()}}},addHighlight=()=>{var a=GLOBAL_CONFIG.highlight;if(a){let{copy:e,expand:t,limit:d,syntax:o}=a,m="prismjs"===o,u=a.enable||e||t||d,g=t?"":"closed";a="highlight.js"===o?document.querySelectorAll("figure.highlight"):document.querySelectorAll('pre[class*="language-"]');if((u||d)&&a.length){let i=e?'<i class="solitude fas fa-copy copy-button"></i>':"<i></i>",s=d?'<i class="solitude fas fa-angles-down"></i>':"<i></i>",l=(e,t)=>utils.snackbarShow(t,!1,2e3),t=e=>{var t=e.parentNode,o=(t.classList.add("copy-true"),window.getSelection()),n=document.createRange(),a=m?"pre code":"table .code pre";n.selectNodeContents(t.querySelectorAll(a)[0]),o.removeAllRanges(),o.addRange(n),document.execCommand("copy"),l(e.lastChild,GLOBAL_CONFIG.lang.copy.success),o.removeAllRanges(),t.classList.remove("copy-true")},o=e=>e.classList.toggle("closed"),c=function(){this.classList.toggle("expand-done")},r=function(e){e=e.target.classList;e.contains("expand")?o(this):e.contains("copy-button")&&t(this)},n=(t,o,e)=>{var n=document.createDocumentFragment();if(u){var a=o.querySelector("figcaption");let e="";a&&(e=`<div class="caption">${a.innerHTML}</div>`,o.removeChild(a));a=document.createElement("div");a.className="highlight-tools "+g,a.innerHTML='<i class="solitude fas fa-angle-down expand"></i>'+t+e+i,utils.addEventListenerPjax(a,"click",r),n.appendChild(a)}d&&o.offsetHeight>d+30&&((t=document.createElement("div")).className="code-expand-btn",t.innerHTML=s,utils.addEventListenerPjax(t,"click",c),n.appendChild(t)),"hl"===e?o.insertBefore(n,o.firstChild):o.parentNode.insertBefore(n,o)};m?a.forEach(e=>{var t=e.getAttribute("data-language")||"Code",t=`<div class="code-lang">${utils.escapeHtml(t)}</div>`;utils.wrap(e,"figure",{class:"highlight"}),n(t,e)}):a.forEach(e=>{let t=e.getAttribute("class").split(" ")[1];"plain"!==t&&void 0!==t||(t="Code");var o=`<div class="code-lang">${utils.escapeHtml(t)}</div>`;n(o,e,"hl")})}}};class toc{static init(){var e,t=document.getElementById("card-toc");t&&t.querySelector(".toc a")?((e=document.querySelectorAll(".toc a")).forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),utils.scrollToDest(utils.getEleTop(document.getElementById(decodeURI(("toc-text"===e.target.className?e.target.parentNode:e.target).hash.replace("#","")))),300)})}),this.active(e)):t.style.display="none"}static active(i){var e=document.querySelector(".article-container");let s=document.getElementById("toc-content"),l=e.querySelectorAll("h1,h2,h3,h4,h5,h6"),c="",t=o=>{if(0===o)return!1;let n="";if(l.forEach((e,t)=>{o>utils.getEleTop(e)-80&&(n=t)}),c!==n){c=n,document.querySelectorAll(".toc .active").forEach(e=>{e.classList.remove("active")});var t,a=i[c];if(a){let e=i[c].parentNode;for(a.classList.add("active"),a=(a=a).getBoundingClientRect().top,t=s.scrollTop,a>document.documentElement.clientHeight-100&&(s.scrollTop=t+150),a<100&&(s.scrollTop=t-150);!e.matches(".toc");e=e.parentNode)e.matches("li")&&e.classList.add("active")}}};window.tocScrollFn=utils.throttle(()=>{var e=window.scrollY||document.documentElement.scrollTop;t(e)},100),window.addEventListener("scroll",tocScrollFn)}}class tabs{static init(){this.clickFnOfTabs()}static clickFnOfTabs(){document.querySelectorAll(".article-container .tab > button").forEach(e=>{e.addEventListener("click",function(){var e=this.parentNode;if(!e.classList.contains("active")){var o=e.parentNode.nextElementSibling,n=utils.siblings(e,".active")[0];n&&n.classList.remove("active"),e.classList.add("active");let t=this.getAttribute("data-href").replace("#","");[...o.children].forEach(e=>{e.classList.toggle("active",e.id===t)})}})})}static lureAddListener(){if(GLOBAL_CONFIG.lure){let t=document.title;document.addEventListener("visibilitychange",()=>{var e=GLOBAL_CONFIG.lure;document.title="hidden"===document.visibilityState?e.jump:e.back,"visible"===document.visibilityState&&setTimeout(()=>{document.title=t},2e3)})}}static expireAddListener(){var e,t,o=GLOBAL_CONFIG.expire;o&&(e=(e=document.querySelectorAll(".post-meta-date time")).length?e[e.length-1]:document.querySelector(".datetime"))&&(e=Math.ceil(((new Date).getTime()-new Date(e.getAttribute("datetime")).getTime())/1e3/60/60/24),o.time>e||((t=document.createElement("div")).className="expire",t.innerHTML='<i class="solitude fas fa-circle-exclamation"></i>'+o.text_prev+-(o.time-e)+o.text_next,document.querySelector(".article-container").insertAdjacentElement("top"===o.position?"afterbegin":"beforeend",t)))}}let scrollFnToDo=()=>{var e=PAGE_CONFIG.toc;if(e){let o=document.getElementById("card-toc");e=o.querySelector(".toc-content");utils.addEventListenerPjax(e,"click",e=>{var t=e.target.closest(".toc-link");t&&(e.preventDefault(),utils.scrollToDest(utils.getEleTop(document.getElementById(decodeURI(t.getAttribute("href")).replace("#",""))),300),window.innerWidth<900)&&o.classList.remove("open")})}},forPostFn=()=>{scrollFnToDo()};window.refreshFn=()=>{var{is_home:e,is_page:t,page:o,is_post:n,ai_text:a}=PAGE_CONFIG,{runtime:i,lazyload:s,lightbox:l,randomlink:c,covercolor:r,lure:d,expire:m}=GLOBAL_CONFIG;document.body.setAttribute("data-type",o),sco.changeTimeFormat(document.querySelectorAll(".datetime, .webinfo-item time, .post-meta-date time")),i&&sco.addRuntime(),[scrollFn,sidebarFn,sco.addPhotoFigcaption,sco.setTimeState,sco.tagPageActive,sco.categoriesBarActive,sco.listenToPageInputPress,sco.musicBind,sco.addNavBackgroundInit,sco.refreshWaterFall].forEach(e=>e()),s.enable&&utils.lazyloadImg(),l&&utils.lightbox(document.querySelectorAll(".article-container img:not(.flink-avatar,.gallery-group img, .no-lightbox)")),c&&randomLinksList(),n&&a&&ai.init(),sco.switchComments(),initObserver(),e&&(showTodayCard(),sco.homeTypeit()),"function"==typeof updatePostsBasedOnComments&&updatePostsBasedOnComments(),(n||t)&&(addHighlight(),tabs.init()),n&&m&&tabs.expireAddListener(),r.enable&&coverColor(),PAGE_CONFIG.toc&&toc.init(),d&&tabs.lureAddListener(),"music"===o&&initializeMusicPlayer(),forPostFn()},document.addEventListener("DOMContentLoaded",()=>{[addCopyright,window.refreshFn,asideStatus,()=>window.onscroll=percent,sco.initConsoleState].forEach(e=>e())}),document.addEventListener("visibilitychange",()=>{document.hidden&&(sco.wasPageHidden=!0)}),window.onkeydown=e=>{var{code:e,ctrlKey:t,shiftKey:o}=e;("F12"===e||t&&o&&("KeyI"===e||"KeyC"===e))&&utils.snackbarShow(GLOBAL_CONFIG.lang.f12,!1,3e3),"Escape"===e&&sco.hideConsole()},document.addEventListener("copy",()=>{utils.snackbarShow(GLOBAL_CONFIG.lang.copy.success,!1,3e3)});